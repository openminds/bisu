require_relative 'test_helper'

describe Bisu::VulnerabilityParser do
  describe '#source' do
    it 'returns the URL ending with the platform name if a platform is specified' do
      assert Bisu::VulnerabilityParser.new(platform: Bisu::Platform.new(name: 'foobar')).source =~ /foobar$/
    end

    it 'returns the URL ending with GENERIC if no platform is specified' do
      assert Bisu::VulnerabilityParser.new.source =~ /GENERIC$/
    end
  end
end
